---
title: "TypeScriptä¸Reactæœ€ä½³å®è·µ"
excerpt: "TypeScriptåœ¨Reactå¼€å‘ä¸­çš„æœ€ä½³å®è·µæŒ‡å—ï¼ŒåŒ…æ‹¬ç±»å‹å®šä¹‰ã€æ¥å£è®¾è®¡ã€ç»„ä»¶ç±»å‹åŒ–ç­‰å†…å®¹ï¼Œå¸®åŠ©ä½ å†™å‡ºæ›´åŠ å¥å£®å’Œå¯ç»´æŠ¤çš„ä»£ç ã€‚"
date: "2024-01-05"
slug: "typescript-react-best-practices"
published: true
---

# TypeScriptä¸Reactæœ€ä½³å®è·µ

TypeScriptä¸ºReactå¼€å‘å¸¦æ¥äº†å¼ºå¤§çš„ç±»å‹å®‰å…¨ä¿éšœã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•åœ¨Reacté¡¹ç›®ä¸­å……åˆ†åˆ©ç”¨TypeScriptçš„ä¼˜åŠ¿ï¼Œå†™å‡ºæ›´åŠ å¥å£®å’Œå¯ç»´æŠ¤çš„ä»£ç ã€‚

## ğŸ¯ åŸºç¡€ç±»å‹å®šä¹‰

### 1. ç»„ä»¶Propsç±»å‹å®šä¹‰

```tsx
// âœ… æ¨èï¼šä½¿ç”¨interfaceå®šä¹‰Props
interface ButtonProps {
  children: React.ReactNode;
  variant?: 'primary' | 'secondary' | 'danger';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;
}

function Button({ children, variant = 'primary', size = 'md', disabled, onClick }: ButtonProps) {
  return (
    <button
      className={`btn btn-${variant} btn-${size}`}
      disabled={disabled}
      onClick={onClick}
    >
      {children}
    </button>
  );
}
```

### 2. ç»„ä»¶çŠ¶æ€ç±»å‹å®šä¹‰

```tsx
interface UserState {
  user: {
    id: string;
    name: string;
    email: string;
  } | null;
  loading: boolean;
  error: string | null;
}

function UserProfile() {
  const [state, setState] = useState<UserState>({
    user: null,
    loading: false,
    error: null,
  });

  // ç±»å‹å®‰å…¨çš„çŠ¶æ€æ›´æ–°
  const updateUser = (userData: UserState['user']) => {
    setState(prev => ({ ...prev, user: userData }));
  };

  return (
    <div>
      {state.loading && <div>åŠ è½½ä¸­...</div>}
      {state.error && <div>é”™è¯¯: {state.error}</div>}
      {state.user && <div>æ¬¢è¿, {state.user.name}!</div>}
    </div>
  );
}
```

## ğŸ—ï¸ é«˜çº§ç±»å‹æŠ€å·§

### 1. æ³›å‹ç»„ä»¶

```tsx
interface ListProps<T> {
  items: T[];
  renderItem: (item: T, index: number) => React.ReactNode;
  keyExtractor?: (item: T) => string | number;
  emptyMessage?: string;
}

function List<T>({ items, renderItem, keyExtractor, emptyMessage = 'æš‚æ— æ•°æ®' }: ListProps<T>) {
  if (items.length === 0) {
    return <div className="empty-state">{emptyMessage}</div>;
  }

  return (
    <ul>
      {items.map((item, index) => (
        <li key={keyExtractor?.(item) ?? index}>
          {renderItem(item, index)}
        </li>
      ))}
    </ul>
  );
}

// ä½¿ç”¨ç¤ºä¾‹
interface User {
  id: string;
  name: string;
  email: string;
}

function UserList({ users }: { users: User[] }) {
  return (
    <List
      items={users}
      keyExtractor={(user) => user.id}
      renderItem={(user) => (
        <div>
          <h3>{user.name}</h3>
          <p>{user.email}</p>
        </div>
      )}
    />
  );
}
```

### 2. æ¡ä»¶ç±»å‹ä¸æ˜ å°„ç±»å‹

```tsx
// æ ¹æ®PropsåŠ¨æ€ç¡®å®šç»„ä»¶ç±»å‹
type ButtonVariant = 'primary' | 'secondary' | 'danger';

type ButtonStyleMap = {
  [K in ButtonVariant]: {
    backgroundColor: string;
    color: string;
    borderColor: string;
  };
};

const buttonStyles: ButtonStyleMap = {
  primary: {
    backgroundColor: '#007bff',
    color: '#ffffff',
    borderColor: '#007bff',
  },
  secondary: {
    backgroundColor: '#6c757d',
    color: '#ffffff',
    borderColor: '#6c757d',
  },
  danger: {
    backgroundColor: '#dc3545',
    color: '#ffffff',
    borderColor: '#dc3545',
  },
};

// ä½¿ç”¨å·¥å…·ç±»å‹
type PartialButtonProps = Partial<ButtonProps>; // æ‰€æœ‰å±æ€§å¯é€‰
type RequiredButtonProps = Required<ButtonProps>; // æ‰€æœ‰å±æ€§å¿…éœ€
type PickedButtonProps = Pick<ButtonProps, 'variant' | 'size'>; // é€‰æ‹©ç‰¹å®šå±æ€§
```

## ğŸ£ Hooksç±»å‹å®šä¹‰

### 1. è‡ªå®šä¹‰Hookç±»å‹

```tsx
interface UseAsyncState<T> {
  data: T | null;
  loading: boolean;
  error: Error | null;
}

interface UseAsyncOptions {
  immediate?: boolean;
}

function useAsync<T>(
  asyncFunction: () => Promise<T>,
  options: UseAsyncOptions = {}
): UseAsyncState<T> & { execute: () => Promise<void> } {
  const [state, setState] = useState<UseAsyncState<T>>({
    data: null,
    loading: false,
    error: null,
  });

  const execute = useCallback(async () => {
    try {
      setState(prev => ({ ...prev, loading: true, error: null }));
      const result = await asyncFunction();
      setState({ data: result, loading: false, error: null });
    } catch (error) {
      setState(prev => ({ 
        ...prev, 
        loading: false, 
        error: error instanceof Error ? error : new Error('Unknown error') 
      }));
    }
  }, [asyncFunction]);

  useEffect(() => {
    if (options.immediate) {
      execute();
    }
  }, [execute, options.immediate]);

  return { ...state, execute };
}

// ä½¿ç”¨ç¤ºä¾‹
function UserComponent() {
  const { data: user, loading, error, execute } = useAsync(
    () => fetch('/api/user').then(res => res.json() as Promise<User>),
    { immediate: true }
  );

  if (loading) return <div>åŠ è½½ä¸­...</div>;
  if (error) return <div>é”™è¯¯: {error.message}</div>;
  if (!user) return <div>æœªæ‰¾åˆ°ç”¨æˆ·</div>;

  return <div>ç”¨æˆ·: {user.name}</div>;
}
```

### 2. Contextç±»å‹å®šä¹‰

```tsx
interface ThemeContextValue {
  theme: 'light' | 'dark';
  toggleTheme: () => void;
}

const ThemeContext = createContext<ThemeContextValue | undefined>(undefined);

function ThemeProvider({ children }: { children: React.ReactNode }) {
  const [theme, setTheme] = useState<'light' | 'dark'>('light');

  const toggleTheme = useCallback(() => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  }, []);

  const value: ThemeContextValue = {
    theme,
    toggleTheme,
  };

  return (
    <ThemeContext.Provider value={value}>
      {children}
    </ThemeContext.Provider>
  );
}

// è‡ªå®šä¹‰Hookç¡®ä¿ç±»å‹å®‰å…¨
function useTheme(): ThemeContextValue {
  const context = useContext(ThemeContext);
  if (context === undefined) {
    throw new Error('useTheme must be used within a ThemeProvider');
  }
  return context;
}
```

## ğŸ”§ è¡¨å•å¤„ç†æœ€ä½³å®è·µ

### 1. å—æ§ç»„ä»¶ç±»å‹

```tsx
interface FormData {
  username: string;
  email: string;
  age: number;
  preferences: {
    newsletter: boolean;
    notifications: boolean;
  };
}

interface FormErrors {
  [K in keyof FormData]?: string;
}

function UserForm() {
  const [formData, setFormData] = useState<FormData>({
    username: '',
    email: '',
    age: 0,
    preferences: {
      newsletter: false,
      notifications: false,
    },
  });

  const [errors, setErrors] = useState<FormErrors>({});

  // ç±»å‹å®‰å…¨çš„å­—æ®µæ›´æ–°å‡½æ•°
  const updateField = <K extends keyof FormData>(
    field: K,
    value: FormData[K]
  ) => {
    setFormData(prev => ({ ...prev, [field]: value }));
    // æ¸…é™¤å­—æ®µé”™è¯¯
    if (errors[field]) {
      setErrors(prev => ({ ...prev, [field]: undefined }));
    }
  };

  // åµŒå¥—å¯¹è±¡æ›´æ–°
  const updatePreference = <K extends keyof FormData['preferences']>(
    key: K,
    value: FormData['preferences'][K]
  ) => {
    setFormData(prev => ({
      ...prev,
      preferences: { ...prev.preferences, [key]: value }
    }));
  };

  const handleSubmit = (e: React.FormEvent) => {
    e.preventDefault();
    // è¡¨å•éªŒè¯å’Œæäº¤é€»è¾‘
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        value={formData.username}
        onChange={(e) => updateField('username', e.target.value)}
      />
      {errors.username && <span className="error">{errors.username}</span>}
      
      <input
        type="email"
        value={formData.email}
        onChange={(e) => updateField('email', e.target.value)}
      />
      {errors.email && <span className="error">{errors.email}</span>}
      
      <button type="submit">æäº¤</button>
    </form>
  );
}
```

## ğŸ¨ æ ·å¼ä¸CSS-in-JSç±»å‹

### 1. styled-componentsç±»å‹

```tsx
import styled from 'styled-components';

interface ButtonStyledProps {
  $variant: 'primary' | 'secondary';
  $size: 'sm' | 'md' | 'lg';
  $fullWidth?: boolean;
}

const StyledButton = styled.button<ButtonStyledProps>`
  padding: ${props => {
    switch (props.$size) {
      case 'sm': return '0.25rem 0.5rem';
      case 'lg': return '0.75rem 1.5rem';
      default: return '0.5rem 1rem';
    }
  }};
  
  background-color: ${props => 
    props.$variant === 'primary' ? '#007bff' : '#6c757d'
  };
  
  width: ${props => props.$fullWidth ? '100%' : 'auto'};
`;

// ä½¿ç”¨æ—¶ç¡®ä¿ç±»å‹å®‰å…¨
function App() {
  return (
    <StyledButton $variant="primary" $size="lg" $fullWidth>
      ç‚¹å‡»æˆ‘
    </StyledButton>
  );
}
```

## ğŸ“š APIè°ƒç”¨ç±»å‹å®‰å…¨

### 1. APIå“åº”ç±»å‹å®šä¹‰

```tsx
interface ApiResponse<T> {
  data: T;
  message: string;
  status: 'success' | 'error';
}

interface User {
  id: string;
  name: string;
  email: string;
  createdAt: string;
}

interface PaginatedResponse<T> {
  items: T[];
  total: number;
  page: number;
  pageSize: number;
}

// APIè°ƒç”¨å‡½æ•°
async function fetchUsers(page: number = 1): Promise<ApiResponse<PaginatedResponse<User>>> {
  const response = await fetch(`/api/users?page=${page}`);
  
  if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
  }
  
  return response.json();
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
function UsersList() {
  const [users, setUsers] = useState<User[]>([]);
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    const loadUsers = async () => {
      setLoading(true);
      try {
        const response = await fetchUsers();
        setUsers(response.data.items);
      } catch (error) {
        console.error('åŠ è½½ç”¨æˆ·å¤±è´¥:', error);
      } finally {
        setLoading(false);
      }
    };

    loadUsers();
  }, []);

  return (
    <div>
      {loading ? (
        <div>åŠ è½½ä¸­...</div>
      ) : (
        <List
          items={users}
          keyExtractor={(user) => user.id}
          renderItem={(user) => <div>{user.name}</div>}
        />
      )}
    </div>
  );
}
```

## âš ï¸ å¸¸è§é™·é˜±ä¸è§£å†³æ–¹æ¡ˆ

### 1. é¿å…anyç±»å‹

```tsx
// âŒ é¿å…ä½¿ç”¨any
function BadComponent(props: any) {
  return <div>{props.whatever}</div>;
}

// âœ… ä½¿ç”¨å…·ä½“ç±»å‹
interface GoodComponentProps {
  title: string;
  content?: React.ReactNode;
}

function GoodComponent({ title, content }: GoodComponentProps) {
  return (
    <div>
      <h1>{title}</h1>
      {content}
    </div>
  );
}
```

### 2. æ­£ç¡®å¤„ç†å¯é€‰å±æ€§

```tsx
// âœ… ä½¿ç”¨é»˜è®¤å‚æ•°
interface ComponentProps {
  required: string;
  optional?: number;
}

function Component({ required, optional = 0 }: ComponentProps) {
  // optionalç°åœ¨ç¡®ä¿æ˜¯numberç±»å‹
  return <div>{required} - {optional + 1}</div>;
}
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ç±»å‹

### 1. React.memoä¸ç±»å‹

```tsx
interface ExpensiveComponentProps {
  data: ComplexData[];
  onItemClick: (id: string) => void;
}

const ExpensiveComponent = React.memo<ExpensiveComponentProps>(
  ({ data, onItemClick }) => {
    return (
      <div>
        {data.map(item => (
          <div key={item.id} onClick={() => onItemClick(item.id)}>
            {item.name}
          </div>
        ))}
      </div>
    );
  },
  // è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°
  (prevProps, nextProps) => {
    return prevProps.data.length === nextProps.data.length &&
           prevProps.onItemClick === nextProps.onItemClick;
  }
);
```

## ğŸ¯ æ€»ç»“

TypeScriptä¸Reactçš„ç»“åˆä¸ºæˆ‘ä»¬æä¾›äº†ï¼š

1. **ç±»å‹å®‰å…¨**ï¼šç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥
2. **æ›´å¥½çš„IDEæ”¯æŒ**ï¼šæ™ºèƒ½æç¤ºå’Œé‡æ„
3. **ä»£ç å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„æ¥å£å®šä¹‰
4. **å›¢é˜Ÿåä½œ**ï¼šä¸€è‡´çš„ä»£ç è§„èŒƒ

è®°ä½è¿™äº›æœ€ä½³å®è·µï¼š

- æ˜ç¡®å®šä¹‰æ‰€æœ‰Propså’ŒStateç±»å‹
- ä½¿ç”¨æ³›å‹åˆ›å»ºå¯å¤ç”¨ç»„ä»¶
- é¿å…ä½¿ç”¨`any`ç±»å‹
- åˆç†ä½¿ç”¨å·¥å…·ç±»å‹
- ä¸ºAPIè°ƒç”¨å®šä¹‰æ¸…æ™°çš„ç±»å‹

---

*ç»§ç»­å­¦ä¹ TypeScriptï¼Œè®©ä½ çš„Reactåº”ç”¨æ›´åŠ å¥å£®ï¼* 